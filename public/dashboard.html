<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale                    <button class="btn btn-outline-primary btn-sm" onclick="refreshDashboard()">
                        <i class="fas fa-sync-alt me-1"></i>
                        Actualizar
                    </button>
                    <button class="btn btn-primary btn-sm" id="createTestDataBtn" onclick="crearDatosPrueba()">
                        <i class="fas fa-database me-1"></i>
                        Crear Base de Prueba
                    </button>
                </div>
            </div>  <title>Dashboard - PsiquiApp</title>
    <!-- Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/bootstrap-custom-psiqui.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
        <div class="container-fluid">
            <button class="btn btn-outline-light d-lg-none me-2" type="button" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
            <a class="navbar-brand fw-bold" href="dashboard.html">
                <i class="fas fa-brain me-2"></i>
                PsiquiApp
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="fas fa-tachometer-alt me-1"></i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Crect width='32' height='32' fill='%234A7C59'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial, sans-serif' font-size='14' fill='%23ffffff'%3EDR%3C/text%3E%3C/svg%3E" class="rounded-circle me-2" alt="Doctor Avatar" id="doctorAvatar">
                            <span id="doctorName" class="d-none d-sm-inline">Cargando...</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="perfil.html"><i class="fas fa-user me-2"></i>Perfil</a></li>
                            <li><a class="dropdown-item" href="configuracion.html"><i class="fas fa-cog me-2"></i>Configuración</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="login.html"><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
   
    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar bg-white shadow-sm">
                <div class="sidebar-header">
                    <h5 class="mb-0">
                        <i class="fas fa-th-list me-2" aria-hidden="true"></i>
                        MENÚ PRINCIPAL
                    </h5>
                </div>
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link active" data-section="dashboard">
                            <i class="fas fa-th-large sidebar-icon"></i>
                            Dashboard
                        </a>
                    </li>
                    <!-- Admin Section - Only visible for admin users -->
                    <li class="sidebar-item" id="adminMenuItem" style="display: none;">
                        <a href="admin.html" class="sidebar-link">
                            <i class="fas fa-user-shield sidebar-icon"></i>
                            Administración
                        </a>
                    </li>
                    <li class="sidebar-divider" id="adminDivider" style="display: none;"></li>
                    <li class="sidebar-item">
                        <a href="pacientes.html" class="sidebar-link">
                            <i class="fas fa-users sidebar-icon"></i>
                            Pacientes
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="consultas.html" class="sidebar-link">
                            <i class="fas fa-notes-medical sidebar-icon"></i>
                            Consultas
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="recetas.html" class="sidebar-link">
                            <i class="fas fa-prescription-bottle-alt sidebar-icon"></i>
                            Recetas Médicas
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="dsm5.html" class="sidebar-link">
                            <i class="fas fa-book sidebar-icon"></i>
                            Guía DSM-5
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="cie10.html" class="sidebar-link">
                            <i class="fas fa-clipboard-list sidebar-icon"></i>
                            CIE-10
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="tests.html" class="sidebar-link">
                            <i class="fas fa-clipboard-check sidebar-icon"></i>
                            Test Psicométricos
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Main Content Area -->
            <div class="col-md-9 col-lg-10 main-content">
        <!-- Suspended Account Warning -->
        <div id="suspendedWarning" class="alert alert-warning alert-dismissible fade show" role="alert" style="display: none;">
            <h4 class="alert-heading">
                <i class="fas fa-exclamation-triangle me-2"></i>
                Cuenta Suspendida - Modo Solo Lectura
            </h4>
            <p class="mb-0">
                Su cuenta ha sido suspendida por el administrador. Puede visualizar toda la información pero no podrá realizar modificaciones, agregar o eliminar datos. Contacte al administrador para más información.
            </p>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <!-- Dashboard Section -->
        <div id="dashboard-section" class="content-section active">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">Panel de control - Sistema de Gestión Psiquiátrica</p>
                </div>
                <div class="page-actions mb-4">
                    <button class="btn btn-outline-primary btn-sm" onclick="refreshDashboard()">
                        <i class="fas fa-sync-alt me-1"></i>
                        Actualizar
                    </button>
                    <button class="btn btn-success btn-sm ms-2" onclick="crearDatosPrueba()" id="btnCrearDatos">
                        <i class="fas fa-database me-1"></i>
                        Crear Datos de Prueba
                    </button>
                </div>
            </div>

            <!-- Estadísticas -->
            <div class="row g-4 mb-4">
                <div class="col-xl-3 col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="flex-shrink-0">
                                    <div class="rounded-3 bg-primary bg-gradient p-3 text-white">
                                        <i class="bi bi-people-fill fs-4"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <h3 class="mb-0 fw-bold text-primary" id="totalPacientes">-</h3>
                                    <p class="text-muted mb-0 small">Pacientes Activos</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="flex-shrink-0">
                                    <div class="rounded-3 bg-info bg-gradient p-3 text-white">
                                        <i class="bi bi-calendar-check-fill fs-4"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <h3 class="mb-0 fw-bold text-info" id="citasHoy">-</h3>
                                    <p class="text-muted mb-0 small">Citas Hoy</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="flex-shrink-0">
                                    <div class="rounded-3 bg-success bg-gradient p-3 text-white">
                                        <i class="bi bi-journal-medical fs-4"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <h3 class="mb-0 fw-bold text-success" id="consultasMes">-</h3>
                                    <p class="text-muted mb-0 small">Consultas este Mes</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="flex-shrink-0">
                                    <div class="rounded-3 bg-warning bg-gradient p-3 text-white">
                                        <i class="bi bi-prescription2 fs-4"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <h3 class="mb-0 fw-bold text-warning" id="recetasActivas">-</h3>
                                    <p class="text-muted mb-0 small">Recetas Activas</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Información Reciente -->
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white border-bottom">
                            <div class="d-flex align-items-center justify-content-between">
                                <h5 class="card-title mb-0 fw-semibold">
                                    <i class="bi bi-calendar-event text-primary me-2"></i>
                                    Próximas Citas
                                </h5>
                                <span class="badge bg-primary-subtle text-primary">Agenda</span>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="proximasCitas" class="text-muted">
                                <div class="d-flex align-items-center justify-content-center py-5">
                                    <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                                    <span>Cargando citas...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white border-bottom">
                            <div class="d-flex align-items-center justify-content-between">
                                <h5 class="card-title mb-0 fw-semibold">
                                    <i class="bi bi-people text-success me-2"></i>
                                    Pacientes Recientes
                                </h5>
                                <span class="badge bg-success-subtle text-success">Nuevos</span>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="pacientesRecientes" class="text-muted">
                                <div class="d-flex align-items-center justify-content-center py-5">
                                    <div class="spinner-border spinner-border-sm text-success me-2" role="status"></div>
                                    <span>Cargando pacientes...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- Alerta Container -->
    <div id="alertContainer" style="position: fixed; top: 100px; right: 20px; z-index: 9999;"></div>

    <!-- Bootstrap 5 JavaScript -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript (v4.0.0 - SIN FUNCIONES DUPLICADAS) -->
    <script src="/js/dashboard.js?v=4.0.0&t=20251001201500"></script>
    
    <!-- Sidebar Toggle Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebar = document.querySelector('.sidebar');
            
            if (sidebarToggle && sidebar) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('show');
                });
                
                // Cerrar sidebar al hacer click fuera en móviles
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 992) {
                        if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target)) {
                            sidebar.classList.remove('show');
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
